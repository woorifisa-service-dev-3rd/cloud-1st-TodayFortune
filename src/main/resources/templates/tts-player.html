<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TTS 플레이어</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>
</head>
<body>
<h1>TTS 플레이어</h1>
<audio id="audioPlayer" controls style="display: none;" muted></audio>

<script>
    async function autoPlay() {
        const audioPlayer = document.getElementById('audioPlayer');

        try {
            // 서버에 TTS 요청
            const response = await axios.get('/api/fortune', {
                responseType: 'blob'  // 바이너리 데이터로 응답 받기
            });

            // Blob URL 생성
            const audioBlob = new Blob([response.data], { type: 'audio/mp3' });
            const audioUrl = URL.createObjectURL(audioBlob);

            // 오디오 플레이어 설정
            audioPlayer.src = audioUrl;
            audioPlayer.style.display = 'block'; // 플레이어 보이기

            // 자동 재생
            audioPlayer.play().catch(error => {
                console.warn('자동 재생 실패:', error);
                alert('음성을 재생하려면 음소거를 해제해 주세요.');
            });
        } catch (error) {
            console.error('오류 발생:', error);
            alert('운세를 가져오는 데 실패했습니다.');
        }
    }

    // 페이지 로드 시 자동 재생
    window.onload = autoPlay;
</script>
</body>
</html>
